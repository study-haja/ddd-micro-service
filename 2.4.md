## 2.4 MSA 구성요소 및 MSA 패턴

- 클라우드 인프라 패턴

  - 퍼블릭 클라우드와 베어 메탈, 프라이빗 클라우드 환경
    - 가상화 장치없이 베어메탈 장비로 마이크로서비스 애플리케이션을 구동한다면 마이크로서비스마다 베어메탈 장비를 구축해야 하고, 인프라의 유연한 확장/축소를 기대하기 힘든 무모한 작업이 될 것이다. 따라서 당연히 가상 인프라 환경을 검토할 필요가 있으며, MSA 시스템을 위한 베어 메탈을 고려한다면 그것은 베어 메탈에 별도의 프라이빗 클라우드 환경을 구축하는 것을 의미한다.

  - VM과 컨테이너

    - VM은 하이퍼바이저(hypervisor)라는 소프트웨어를 이용해 하나의 시스템에서 여러 개의 운영체제를 사용하는 기술이다. 반면 컨테이너는 하이퍼바이저 없이 컨테이너 엔진을 사용해 가상의 격리된 공간을 생성한다.

    - 도커 컨테이너는 다음과 같은 이점이 있다.

      - 이식성 : 어떠한 호스트 커널이나 플랫폼 버전에 상관없이 도커만 실행할 수 있으면 사용 가능

      - 신속성 : 크기가 OS비해 훨씬 작고 가볍기 때문에 빠르게 배포 가능하며, 문제 발생 시 수정할 필요없이 새로 기동하면 된다.

      - 재사용성 : 동일한 환경을 재사용해서 쉽게 설정 가능하기 때문에 개발, 테스트, 스테이징, 프로덕트 환경을 동일한 환경으로 구축하기가 쉽다.


  - 컨테이너 오케스트레이션
    - 컨테이너를 관리하기 위한 기술을 말하며, Docker Swarm, Apache Mesos, Kubernetes등이 있다.
    - 쿠버네티스는 다음과 같은 주요기능을 제공한다.
      - 자동화된 자원 배정(Automatic binpacking) : 각 컨테이너가 필요로 하는 CPU와 메모리를 쿠버네티스에 요청하면 컨테이너를 노드에 맞춰 자동으로 배치한다.
      - Self-healing : 컨테이너의 이상 유무를 점검(health check)해서 실패한 경우 자동으로 교체하고 재스케줄링한다.
      - Horizontal scaling : 일정 CPU 및 메모리 사용량을 초과하면 자동으로 확장한다.

