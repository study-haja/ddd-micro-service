## 레이어드 아키텍처

* 레이어드 아키텍처는 티어 내부의 논리적인 분할을 의미
* 구성
  * 프레젠테이션 - 화면 표현 및 전환 처리 (상위)
  * 비즈니스 로직 - 비즈니스 개념 규칙, 흐름제어
  * 데이터 액세스 - 데이터 처리 (하위)
* 레이어 간 응집성을 높이고 의존도를 낮추기 위해 다음과 같은 몇가지 규칙을 둠
  * 상위 계층이 하위 계층을 호출하는 단방향성을 유지
  * 상위 계층은 하위의 여러 계층을 모두 알 필요 없이 바로 밑의 근접 계층만 활용
  * 상위 계층이 하위 계층에 영향을 받지 않게 구성
  * 하위 계층은 자신을 사용하는 상위 계층을 알지 못하게 구성
  * 계층 간의 호출은 인터페이스를 통해 호출하는 것이 바람직함 (구현 클래스에 직접 의존하지 않음 -> 약 결합)
* 레이어드 아키텍처의 문제
  * 레이어드 아키텍처는 DIP는 만족하지만 OCP는 만족하지 못함
  * 레이어드 아키텍처 구조가 모든 계층이 각기 자신이 제공하는 기능에 대한 추상적인 인터페이스를 직접 정의하고 소유하고 있음
  * 이러한 구조는 제어 흐름이 상위 계층에서 하위 계층으로 흐르게 됌
  * 이에 따른 소스코드의 의존성은 제어 흐름의 방향대로 따를 수 밖에 없음
  * 예를 들면 다음과 같음
    * 데이터 액세스 계층이 변경 됐을 때 비즈니스 로직 계층이 변경되면 안됌
    * 만약 데이터 액세스 계층의 구현체가 인터페이스 B를 상속받은 클래스 C에서 D로 교체된 경우에는 비즈니스 로직 계층은 영향을 받지 않음
    * 하지만 데이터 액세스 계층의 인터페이스 B가 변경되면 비즈니스 로직 계층이 전체 영향을 받음
  * 즉 인터페이스 위치때문에 상위 계층이 하위 계층을 의존하게 됌
  * 따라서 해결법은 다음과 같음
    * 보통 애플리케이션 계층은 고수준 영역이라 부르고 프레젠테이션, 데이터 액세스 계층은 저수준 영역이라 부름
    * DIP를 적용해 데이터 액세스 계층에서 정의한 인터페이스를 경계를 넘어 비즈니스 로직 계층으로 이동
    * 즉 의존성을 역전시켜 고수준 영역이 저수준 영역의 변경에 영향을 받지 않게 하는 것