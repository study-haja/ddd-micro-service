## 3.3.3 외부 영역 - 세부사항

* 외부 영역은 내부 영역의 서비스 인터페이스를 사용하는 인바운드 어댑터와 내부 영역에서 선언한 아웃바운드 인터페이스를 구현하는 다양한 어댑터로 구성한다.
* 이 어댑터들은 언제나 교체되거나 확장이 될 수 있도록 해야한다.



### API 퍼블리싱 어댑터

* REST API를 발행하는 인바운드 어댑터다.
* 내부 영역에 서비스 인터페이스를 호출해서 REST 형식의 API로 제공한다.
* 엔티티를 직접 제공하지 않고 API의 필요에 맞는 DTO를 생성해서 엔티티를 변환 및 매핑해서 전달하는 것이 바람직하다.



### API 프락시 어댑터

* 다른 서비스의 API를 호출하는 아웃바운드 어댑터다.
* 내부 영역에 정의된 프락시 인터페이스를 구현하며, 다른 서비스의 API는 REST 혹은 소켓, SOAP 프로토콜을 사용하는 API일 수 있다.



### 저장소 처리 어댑터

* 저장소 처리 어댑터의 매커니즘은 크게 OR 매핑과 SQL 매핑이 있다.
* SQL 매핑
  * 트랜잭션 스크립트 패턴을 사용할 경우 사용
  * 마이바티스
  * 질의문을 수동으로 작성해야하기 때문에 세밀한 SQL 제어가 필요할 경우 유용
* OR 매핑
  * 도메인 모델 패턴을 사용할 경우 사용
  * JPA
  * OR 매퍼가 런타임 시 저장소에 따라 자동으로 질의문을 생성 -> 생산성 향상
  * 설정에 따라 손쉽게 저장소를 변경 가능
  * 객체 모델링에 익숙해야 하기 때문에 학습 곡선이 높음



### 도메인 이벤트 발행 어댑터

* 서비스간 비동기 메시지 통신을 했을 때 전달 대상이 되는 정보가 도메인 이벤트이다.
* 전달 대상을 가지고 컨슈머에게 전달 할 때 이벤트 발행 어댑터를 통해 발행된다.
* 애그리거트 패턴을 적용할 경우 도메인 이벤트는 애그리거트에서 발생한 사건이 된다.
* 실제로 도메인 이벤트가 생성되는 위치는 내부영역이며, 도메인 이벤트 발행 어댑터는 내부 영역의 이벤트 인터페이스를 구현해서 아웃바운드로 특정 메시지 큐나 스트림 저장소에 발행하는 역할을 수행한다.



### 도메인 이벤트 핸들러

* 도메인 이벤트가 발행 되면 수신하는 인바운드 어댑터를 도메인 이벤트 핸들러라 한다
* 이벤트 상태에 따라 적절한 서비스 인터페이스를 호출해서 내부 영역에 이벤트를 전달한다.

