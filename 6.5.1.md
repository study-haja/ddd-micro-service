## MSA 외부 아키텍처 구성 (게이트웨이, 레지스트리 서비스)



### JHipster란?

* 모던 웹 애플리케이션과 마이크로서비스 아키텍처를 빠르게 적용, 개발, 배포할 수 있도록 도와주는 오픈 소스 개발 플랫폼



### JHipster의 목적

* 완전하고 현대적인 웹 애플리케이션과 마이크로서비스 아키텍처를 생성하는데 있으며, 다음과 같은 항목들을 통합하는게 목표
  * 광범위한 테스트를 커버할 수 있는 우수한 성능의 강력한 서버 스택
  * 세련되고 현대적인 모바일 친화적 UI를 위한 기능
  * 웹팩 및 메이븐, 그래들을 사용해 애플리케이션을 빌드하는 강력한 워크플로우
  * 클라우드에 빠르게 배포할 수 있는 코드 기반 인프라
* 현대적인 애플리케이션 개발에 필요한 환경을 구축하고 라이브러리를 자동으로 설치
* 기본적인 인증처리 및 REST API 지원



### JHipster 마이크로서비스 아키텍처

* JHipster 레지스트리 : MSA 디스커버리 패턴의 구현, 다른 모든 구성요소를 서로 연결하고 서로 통신하게 할 수 있는 역할을 한다.	
  * 유레카, 스프링 클라우드 컨피그 기반
* 마이크로서비스 : 백엔드 코드가 들어 있고, 실행 후 도메인에 대한 API를 노출한다.
  * 여러개의 마이크로서비스 구성 될 수 있고, 몇 개의 엔티티와 비즈니스 규칙이 포함
* 게이트웨이 : 모든 프런트엔드 코드를 가지고 있으며, 전체 마이크로서비스에서 생성한 API를 사용한다.
  * 줄 프락시, 리본을 사용
* 백앤드 소스코드 : src/main/java
* 프론트엔드 소스코드 : src/main/webapp



### JHipster 환경 구축

* 자바11, nodejs, JHipster를 설치해야 한다.
* 그 밖에 Git, Docker 등을 필요에 따라 설치한다.



### JHipster로 개발 시작하기

* JHipster를 이용하면 손쉽게 내외부 아키텍처 및 개발 환경을 구축 할 수 있다.
* JHipster로 마이크로서비스 애플리케이션을 개발하는 순서는 다음과 같다.
  1. 게이트웨이 생성
  2. 레지스트리 생성
  3. 마이크로서비스 생성
  4. 생성한 마이크로서비스에 엔티티 생성
  5. 생성된 엔티티를 게이트웨이가 인식할 수 있도록 게이트웨이 등록



### 게이트웨이 만들기

* gateway 폴더를 생성한다.
* gateway 폴터를 JHipster 프로젝트로 설정한다
* 옵션을 환경에 맞게 선택한다.
* 그러면 JHipster에서 레지스트리와 게이트웨이를 생성하게 된다.



### 레지스트리 및 게이트웨이 실행

* 소스코드는 하나의 프로젝트에 모두 포함돼 있지만 서비스는 별도로 구동해야 한다.
* 도커컴포즈로 레지스트리를 실행시키고 콘솔에 표시된 url로 들어가면 레지스트리 화면이 나오게 된다.
* 다음 게이트웨이를 실행한다.
* 빌드 환경(메이븐, 그래들)을 사용해 실행시키면 콘솔에 게이트웨이의 url이 나오게 되고 접속하면 게이트웨이 화면이 나오게 된다.
* 이후 백엔드 마이크로서비스와 엔티티를 만들면, 레지스트리 화면에는 서비스, 게이트웨이 화면에는 엔티티 정보가 나오게 된다.